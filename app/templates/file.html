{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<h1> Informazioni del file: {{ file.nome }}</h1>
<h3>Hash: {{ file.fhash }}</h3>
<h3>Peso: {{ file.peso }} bytes</h3>
{% for a in filestoanalisi %}
    <h1>Dati di analisi del {{ a.analisi.datatime }}:</h1>
    <h3>Tipo di analisi {{ a.analisi.tipo }}</h3>
    <h3>Analyzer: {{ a.analisi.analyzer.nome }}</h3>
    <h3>Output: <a href="/download/{{ a.files.fhash }}{{ a.analisi.id }}.txt">Download Output</a></h3>
{% endfor %}
{% if contenimento %}
    <h3>Minaccie rilevate:</h3>
{% endif %}
{% for min in contenimento %}
    <h3> {{ min.minaccia.nome }}</h3>
{% endfor %}
<h5> Scegli quale analyzer utilizzare per la scansione: </h5>  
<form method="post">
    {% csrf_token %}
    {{ form|crispy }}
    <div class="text-center p-3">
        <input type="submit" class="btn btn-danger" value="INVIA">
    </div>
</form>

<h5> Nella tabella sono indicati gli analyzer disponibili</h5>
<table class="table">
    <thead class="table-dark">
        <tr>
            <th>Nome</th>
            <th>Versione</th>
            <th>Produttore</th>
            <th>Tipo</th>
        </tr>
    </thead>
    {% for analyzer in analyzers %}
        <tr>
            <td>{{ analyzer.nome }}</td>
            <td>{{ analyzer.version }}</td>
            <td>{{ analyzer.produttore.nome }}</td>
            <td>{{ analyzer.type }}</td>
        </tr>
    {% endfor %}
</table>
{% endblock content %}
